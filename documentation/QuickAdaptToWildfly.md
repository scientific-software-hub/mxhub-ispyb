# Quickly Adapt to WildFly

 1. Import the maven modules

 2. Import the new sources in `src/main/java` in the correct packages

 3. Import the new js and jsp in `src/main/webapp`

 4. Replace in files:

    This:
    
    ```java
    import org.apache.cxf.interceptor.security.AccessDeniedException;
    ```

    with:

    ```java
    import java.nio.file.AccessDeniedException;
    ```

    This:

    ```java
    import org.jboss.wsf.spi.annotation.WebContext;
    ```

    with:

    ```java
    import org.jboss.ws.api.annotation.WebContext;
    ```

    This:

    ```java
    import org.hibernate.engine.SessionFactoryImplementor;
    ```

    with:

    ```java
    import org.hibernate.engine.spi.SessionFactoryImplementor;
    ```

 4. Replace the ejb3Locator

 5. JSPs

    If pbs in JSP files, check:

    ```jsp
    <%@ page isELIgnored="false" %>
    ```

 6. Some runtime errors on the following libs:

    ```java
    com.sun.xml.bind.CycleRecoverable
    ```

    * Used in VOs for BioSaxs (VOs generated by hibernate)

    ```java
    org.apache.http.client.methods.HttpUriRequest
    ```

    * Used for dataconfidentiality calls

    The libs and their corresponding calls have been removed but this has to be
    fixed.

 7. Replace the webservices calls: use `SMISWebServicedGenerator.java`:

    ```java
    package ispyb.server.webservice.smis.util;

    import generated.ws.smis.SMISWebService;
    import generated.ws.smis.SMISWebService_Service;
    import ispyb.common.util.Constants;

    import java.util.Map;

    import javax.xml.ws.BindingProvider;

    public class SMISWebServiceGenerator {
      public static SMISWebService getSMISWebService()  {
        SMISWebService_Service sws = new SMISWebService_Service();
        SMISWebService wsPort = sws.getSMISWebServiceBeanPort();

        //SMISWebService ws=service.get
        BindingProvider bindingProvider = (BindingProvider)wsPort;
        Map requestContext = bindingProvider.getRequestContext();
        String usern = Constants.SMIS_WS_USERNAME;
        String userp = Constants.SMIS_WS_PWD;

        usern="*****";
        userp="*****";

        requestContext.put(BindingProvider.USERNAME_PROPERTY, usern);
        requestContext.put(BindingProvider.PASSWORD_PROPERTY, userp);

        return wsPort;
      }

      public static SMISWebService getWs() throws Exception {
        return getSMISWebService();
      }
    }
    ```

    Generate the classes from wsdl using the project `ispyb-WSClient-gen`, then
    copy the jar in `lib` of the other modules needing it.

 8. BCR module

    Replace:

    ```java
    import ispyb.server.common.util.ejb.Ejb3ServiceLocator;
    ```

    with:

    ```java
    import bcr.common.util.Ejb3ServiceLocator;
    ```
